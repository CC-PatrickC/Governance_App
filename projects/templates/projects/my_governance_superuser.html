{% extends 'base_cc.html' %}
{% load static %}

{% block title %}MyGovernance-test - SuperUser{% endblock %}

{% block extra_css %}
<style>
    /* Force horizontal scroll at browser level */
    html, body {
        overflow-x: auto !important;
        min-width: 2000px !important;
    }
    
    /* Make table extremely wide to force scroll */
    .table-responsive {
        overflow-x: visible !important;
        width: 100% !important;
    }
    
    .table-responsive table {
        width: 2000px !important;
        min-width: 2000px !important;
    }
    
    /* Set table font size to 14px */
    .table-responsive table,
    .table-responsive table th,
    .table-responsive table td {
        font-size: 14px !important;
    }
    
    /* Remove all width constraints */
    .container-fluid {
        max-width: none !important;
        width: 100% !important;
        overflow-x: visible !important;
    }
    
    .row {
        max-width: none !important;
        width: 100% !important;
    }
    
    .col-12 {
        max-width: none !important;
        width: 100% !important;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1 class="page-title">MyGovernance-test</h1>
                <div class="badge bg-warning text-dark">
                    <i class="fas fa-flask me-1"></i>Test Page
                </div>
            </div>
        </div>
    </div>

    <!-- All Requests Table -->
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <div class="dropdown">
                        <button class="btn btn-link dropdown-toggle p-0 text-decoration-none" type="button" id="requestsDropdown" data-bs-toggle="dropdown" aria-expanded="false" style="color: #D09B2C; font-size: 1.25rem; font-weight: 500;">
                            All Requests
                        </button>
                        <ul class="dropdown-menu" aria-labelledby="requestsDropdown">
                            <li><a class="dropdown-item" href="#">All Requests</a></li>
                            <li><a class="dropdown-item" href="#">My Requests</a></li>
                            <li><a class="dropdown-item" href="#">Assigned Requests</a></li>
                            <li><a class="dropdown-item" href="#">Triage Requests</a></li>
                            <li><a class="dropdown-item" href="#">Governance Requests</a></li>
                            <li><a class="dropdown-item" href="#">Final Governance Requests</a></li>
                        </ul>
                    </div>
                </div>
                <div class="card-body">
                        {% if all_projects %}
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th style="width: 125px; max-width: 125px;">Request ID</th>
                                    <th>Title</th>
                                    <th>Requester</th>
                                    <th>Triage Team Member</th>
                                    <th>Committee</th>
                                    <th>Stage</th>
                                    <th>Created Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for project in all_projects %}
                                <tr>
                                    <td style="width: 125px; max-width: 125px;">
                                        <span class="badge" style="background-color: #D09B2C; color: white;">{{ project.formatted_id }}</span>
                                    </td>
                                    <td style="width: 200px; max-width: 200px; word-wrap: break-word; white-space: normal;">
                                        {{ project.title }}
                                    </td>
                                    <td style="white-space: nowrap;">
                                        {% if project.submitted_by %}
                                            {{ project.submitted_by.get_full_name|default:project.submitted_by.username }}
                                        {% else %}
                                            <span class="text-muted">Unknown</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if project.triaged_by %}
                                            {{ project.triaged_by.get_full_name|default:project.triaged_by.username }}
                                        {% else %}
                                            <span class="text-muted">Not Assigned</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if project.project_type == 'ai_governance' %}
                                            <span>AI Governance</span>
                                        {% elif project.project_type == 'erp_governance' %}
                                            <span>ERP Governance</span>
                                        {% elif project.project_type == 'it_governance' %}
                                            <span>IT Governance</span>
                                        {% elif project.project_type == 'process_improvement' %}
                                            <span>Process Improvement</span>
                                        {% elif project.project_type == 'data_governance' %}
                                            <span>Data Governance</span>
                                        {% else %}
                                            <span>{{ project.get_project_type_display }}</span>
                                        {% endif %}
                                    </td>
                                    <td>
                                        {% if project.stage == 'Pending_Review' %}
                                            <span>Pending Review</span>
                                        {% elif project.stage == 'Under_Review_Triage' %}
                                            <span>Under Review - Triage</span>
                                        {% elif project.stage == 'Under_Review_governance' %}
                                            <span>Under Review - Governance</span>
                                        {% elif project.stage == 'Under_Review_Final_governance' %}
                                            <span>Under Review - Final Governance</span>
                                        {% elif project.stage == 'Governance_Closure' %}
                                            <span>Governance Closed</span>
                                        {% elif project.stage == 'Deleted' %}
                                            <span>Deleted</span>
                                        {% else %}
                                            <span>{{ project.get_stage_display }}</span>
                                        {% endif %}
                                    </td>
                                    <td style="white-space: nowrap;">
                                        <small>
                                            {{ project.submission_date|date:"M d, Y g:i A" }} MST
                                        </small>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    {% else %}
                    <div class="text-center py-4">
                        <i class="fas fa-inbox fa-3x text-muted mb-3"></i>
                        <h5 class="text-muted">No Requests Found</h5>
                        <p class="text-muted">There are no requests in the system yet.</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
